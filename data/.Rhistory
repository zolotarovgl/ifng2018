ylab('Gene')+
xlab('Cell line')+
scale_fill_gradient2(low = "darkblue",midpoint=0,mid ='white', high = "red",name = 'log2 Change')+
theme(panel.border = element_blank(),
panel.background = element_blank()
)
ggplot(data[data$symbol%in%topgenes,], aes(x = line, y= symbol)) +
geom_tile(aes(fill = value), color = "black") +
geom_text(aes(label = pval),cex=3)+
ylab('Gene')+
xlab('Cell line')+
scale_fill_gradient2(low = "darkblue",midpoint=0,mid ='white', high = "red",name = 'log2 Change')+
theme(panel.border = element_blank(),
panel.background = element_blank()
)
ggplot(data[data$ensembl%in%topgenes,], aes(x = line, y= symbol)) +
geom_tile(aes(fill = value), color = "black") +
geom_text(aes(label = pval),cex=3)+
ylab('Gene')+
xlab('Cell line')+
scale_fill_gradient2(low = "darkblue",midpoint=0,mid ='white', high = "red",name = 'log2 Change')+
theme(panel.border = element_blank(),
panel.background = element_blank()
)
data$ensembl
colnames(data)
desseq2$B16$line = 'b16'
desseq2$TC1A9$line = 'tc1a9'
data = rbind(desseq2$B16,desseq2$TC1A9)
data = data%>%filter(padj<0.05)%>%select(symbol,ensembl,padj,log2FoldChange)
data = data%>%filter(padj<0.05)%>%select(symbol,ensembl,padj,log2FoldChange)
ggplot(data[data$ensembl%in%topgenes,], aes(x = line, y= symbol)) +
geom_tile(aes(fill = log2FoldChange), color = "black") +
geom_text(aes(label = pval),cex=3)+
ylab('Gene')+
xlab('Cell line')+
scale_fill_gradient2(low = "darkblue",midpoint=0,mid ='white', high = "red",name = 'log2 Change')+
theme(panel.border = element_blank(),
panel.background = element_blank()
)
data$ensembl
topgenes
data[data$ensembl%in%topgenes,]
desseq2$TC1A9$line = 'tc1a9'
data = rbind(desseq2$B16,desseq2$TC1A9)
data = data%>%filter(padj<0.05)%>%select(symbol,ensembl,padj,log2FoldChange)
data[data$ensembl%in%topgenes,]
desseq2$B16$line = 'b16'
desseq2$TC1A9$line = 'tc1a9'
data = rbind(desseq2$B16,desseq2$TC1A9)
data
data = data%>%filter(padj<0.05)%>%select(symbol,ensembl,padj,log2FoldChange,line)
ggplot(data[data$ensembl%in%topgenes,], aes(x = line, y= symbol)) +
geom_tile(aes(fill = log2FoldChange), color = "black") +
geom_text(aes(label = pval),cex=3)+
ylab('Gene')+
xlab('Cell line')+
scale_fill_gradient2(low = "darkblue",midpoint=0,mid ='white', high = "red",name = 'log2 Change')+
theme(panel.border = element_blank(),
panel.background = element_blank()
)
ggplot(data[data$ensembl%in%topgenes,], aes(x = line, y= symbol)) +
geom_tile(aes(fill = log2FoldChange), color = "black") +
geom_text(aes(label = padj),cex=3)+
ylab('Gene')+
xlab('Cell line')+
scale_fill_gradient2(low = "darkblue",midpoint=0,mid ='white', high = "red",name = 'log2 Change')+
theme(panel.border = element_blank(),
panel.background = element_blank()
)
geom_text(aes(label = round(padj,2),cex=3)+
ggplot(data[data$ensembl%in%topgenes,], aes(x = line, y= symbol)) +
geom_tile(aes(fill = log2FoldChange), color = "black") +
geom_text(aes(label = round(padj,2)),cex=3)+
ylab('Gene')+
xlab('Cell line')+
scale_fill_gradient2(low = "darkblue",midpoint=0,mid ='white', high = "red",name = 'log2 Change')+
theme(panel.border = element_blank(),
panel.background = element_blank()
)
ggplot(data[data$ensembl%in%topgenes,], aes(x = line, y= symbol)) +
geom_tile(aes(fill = log2FoldChange), color = "black") +
geom_text(aes(label = round(padj,3)),cex=3)+
ylab('Gene')+
xlab('Cell line')+
scale_fill_gradient2(low = "darkblue",midpoint=0,mid ='white', high = "red",name = 'log2 Change')+
theme(panel.border = element_blank(),
panel.background = element_blank()
)
geom_text(aes(label = signif(padj, digits = 2),cex=3)+
ggplot(data[data$ensembl%in%topgenes,], aes(x = line, y= symbol)) +
ggplot(data[data$ensembl%in%topgenes,], aes(x = line, y= symbol)) +
ggplot(data[data$ensembl%in%topgenes,], aes(x = line, y= symbol)) +
geom_tile(aes(fill = log2FoldChange), color = "black") +
geom_text(aes(label = signif(padj, digits = 2),cex=3))+
ylab('Gene')+
xlab('Cell line')+
scale_fill_gradient2(low = "darkblue",midpoint=0,mid ='white', high = "red",name = 'log2 Change')+
theme(panel.border = element_blank(),
panel.background = element_blank()
)
ggplot(data[data$ensembl%in%topgenes,], aes(x = line, y= symbol)) +
geom_tile(aes(fill = log2FoldChange), color = "black") +
geom_text(aes(label = signif(padj, digits = 2),cex=2))+
ylab('Gene')+
xlab('Cell line')+
scale_fill_gradient2(low = "darkblue",midpoint=0,mid ='white', high = "red",name = 'log2 Change')+
theme(panel.border = element_blank(),
panel.background = element_blank()
)
ggplot(data[data$ensembl%in%topgenes,], aes(x = line, y= symbol)) +
geom_tile(aes(fill = log2FoldChange), color = "black") +
geom_text(aes(label = signif(padj, digits = 2),cex=1))+
ylab('Gene')+
xlab('Cell line')+
scale_fill_gradient2(low = "darkblue",midpoint=0,mid ='white', high = "red",name = 'log2 Change')+
theme(panel.border = element_blank(),
panel.background = element_blank()
)
data$padj = signif(data$padj, digits = 3)
ggplot(data[data$ensembl%in%topgenes,], aes(x = line, y= symbol)) +
geom_tile(aes(fill = log2FoldChange), color = "black") +
geom_text(aes(label = padj,cex=1))+
ylab('Gene')+
xlab('Cell line')+
scale_fill_gradient2(low = "darkblue",midpoint=0,mid ='white', high = "red",name = 'log2 Change')+
theme(panel.border = element_blank(),
panel.background = element_blank()
)
data$padj = signif(data$padj, digits = 2)
ggplot(data[data$ensembl%in%topgenes,], aes(x = line, y= symbol)) +
geom_tile(aes(fill = log2FoldChange), color = "black") +
geom_text(aes(label = padj,cex=1))+
ylab('Gene')+
xlab('Cell line')+
scale_fill_gradient2(low = "darkblue",midpoint=0,mid ='white', high = "red",name = 'log2 Change')+
theme(panel.border = element_blank(),
panel.background = element_blank()
)
data$padj
data = rbind(desseq2$B16,desseq2$TC1A9)
data = data%>%filter(padj<0.05)%>%select(symbol,ensembl,padj,log2FoldChange,line)
data$padj = signif(data$padj, digits = 2)
ggplot(data[data$ensembl%in%topgenes,], aes(x = line, y= symbol)) +
geom_tile(aes(fill = log2FoldChange), color = "black") +
geom_text(aes(label = padj,cex=1))+
ylab('Gene')+
xlab('Cell line')+
scale_fill_gradient2(low = "darkblue",midpoint=0,mid ='white', high = "red",name = 'log2 Change')+
theme(panel.border = element_blank(),
panel.background = element_blank()
)
ggplot(data[data$ensembl%in%topgenes,], aes(x = line, y= symbol)) +
geom_tile(aes(fill = log2FoldChange), color = "black") +
geom_text(aes(label = padj),cex=10)+
ylab('Gene')+
xlab('Cell line')+
scale_fill_gradient2(low = "darkblue",midpoint=0,mid ='white', high = "red",name = 'log2 Change')+
theme(panel.border = element_blank(),
panel.background = element_blank()
)
ggplot(data[data$ensembl%in%topgenes,], aes(x = line, y= symbol)) +
geom_tile(aes(fill = log2FoldChange), color = "black") +
geom_text(aes(label = padj),cex=1)+
ylab('Gene')+
xlab('Cell line')+
scale_fill_gradient2(low = "darkblue",midpoint=0,mid ='white', high = "red",name = 'log2 Change')+
theme(panel.border = element_blank(),
panel.background = element_blank()
)
ggplot(data[data$ensembl%in%topgenes,], aes(x = line, y= symbol)) +
geom_tile(aes(fill = log2FoldChange), color = "black") +
geom_text(aes(label = padj),cex=3)+
ylab('Gene')+
xlab('Cell line')+
scale_fill_gradient2(low = "darkblue",midpoint=0,mid ='white', high = "red",name = 'log2 Change')+
theme(panel.border = element_blank(),
panel.background = element_blank()
)
#heatmap for significant genes:
up = desseq2$IFNG%>%filter(padj<0.05)%>% arrange(-log2FoldChange)%>%head(10)%>%select(ensembl)%>%pull()
down = desseq2$IFNG%>%filter(padj<0.05)%>% arrange(-log2FoldChange)%>%tail(10)%>%select(ensembl)%>%pull()
topgenes = c(as.character(up),as.character(down))
data[data$ensembl%in%topgenes,]
desseq2$B16$line = 'b16'
desseq2$TC1A9$line = 'tc1a9'
data = rbind(desseq2$B16,desseq2$TC1A9)
data = data%>%select(symbol,ensembl,padj,log2FoldChange,line)
data$padj = signif(data$padj, digits = 2)
ggplot(data[data$ensembl%in%topgenes,], aes(x = line, y= symbol)) +
geom_tile(aes(fill = log2FoldChange), color = "black") +
geom_text(aes(label = padj),cex=3)+
ylab('Gene')+
xlab('Cell line')+
scale_fill_gradient2(low = "darkblue",midpoint=0,mid ='white', high = "red",name = 'log2 Change')+
theme(panel.border = element_blank(),
panel.background = element_blank()
)
ggplot(data[data$ensembl%in%topgenes,], aes(x = line, y= symbol)) +
geom_tile(aes(fill = log2FoldChange), color = "black") +
geom_text(aes(label = padj),cex=3)+
ylab('Gene')+
xlab('Cell line')+
title('sdfsf'+)
ggplot(data[data$ensembl%in%topgenes,], aes(x = line, y= symbol)) +
geom_tile(aes(fill = log2FoldChange), color = "black") +
geom_text(aes(label = padj),cex=3)+
ylab('Gene')+
xlab('Cell line')+
title('sdfsf')+
scale_fill_gradient2(low = "darkblue",midpoint=0,mid ='white', high = "red",name = 'log2 Change')+
theme(panel.border = element_blank(),
panel.background = element_blank()
)
ggplot(data[data$ensembl%in%topgenes,], aes(x = line, y= symbol)) +
geom_tile(aes(fill = log2FoldChange), color = "black") +
geom_text(aes(label = padj),cex=3)+
ylab('Gene')+
xlab('Cell line')+
ggtitle('sdfsf')+
scale_fill_gradient2(low = "darkblue",midpoint=0,mid ='white', high = "red",name = 'log2 Change')+
theme(panel.border = element_blank(),
panel.background = element_blank()
)
data$symbol= factor(data$symbol,levels = unique(data$symbol))
ggplot(data[data$ensembl%in%topgenes,], aes(x = line, y= symbol)) +
geom_tile(aes(fill = log2FoldChange), color = "black") +
geom_text(aes(label = padj),cex=3)+
ylab('Gene')+
xlab('Cell line')+
ggtitle('sdfsf')+
scale_fill_gradient2(low = "darkblue",midpoint=0,mid ='white', high = "red",name = 'log2 Change')+
theme(panel.border = element_blank(),
panel.background = element_blank()
)
unique(data$symbol)
data[data$ensembl%in%topgenes,]%>%arrage(rowMeans())
data$ensembl%in%topgenes,]%>%arrange(rowMeans())
data[data$ensembl%in%topgenes,]%>%arrange(rowMeans())
plot = data[data$ensembl%in%topgenes,]
plot%>%group_by(symbol)%>%arrange(symbol =symbol,mean = mean)
ggplot(data[data$ensembl%in%topgenes,], aes(x = line, y= symbol)) +
geom_tile(aes(fill = log2FoldChange), color = "black") +
geom_text(aes(label = padj),cex=3)+
ylab('Gene')+
xlab('Cell line')+
ggtitle('Expression changes')+
scale_fill_gradient2(low = "darkblue",midpoint=0,mid ='white', high = "red",name = 'log2 Change')+
theme(panel.border = element_blank(),
panel.background = element_blank()
)
b16$line = 'b16'
tc$line = 'tc1a9'
desseq2$B16$line = 'B16'
desseq2$TC1A9$line = 'TC1A9'
data = rbind(desseq2$B16,desseq2$TC1A9)
data = data%>%select(symbol,ensembl,padj,log2FoldChange,line)
data$padj = signif(data$padj, digits = 2)
plot = data[data$ensembl%in%topgenes,]
plot$symbol= factor(data$symbol,levels = unique(data$symbol))
ggplot(data[data$ensembl%in%topgenes,], aes(x = line, y= symbol)) +
geom_tile(aes(fill = log2FoldChange), color = "black") +
geom_text(aes(label = padj),cex=3)+
ylab('Gene')+
xlab('Cell line')+
ggtitle('Expression changes')+
scale_fill_gradient2(low = "darkblue",midpoint=0,mid ='white', high = "red",name = 'log2 Change')+
theme(panel.border = element_blank(),
panel.background = element_blank()
)
ggplot(plot, aes(x = line, y= symbol)) +
geom_tile(aes(fill = log2FoldChange), color = "black") +
geom_text(aes(label = padj),cex=3)+
ylab('Gene')+
xlab('Cell line')+
ggtitle('Expression changes')+
scale_fill_gradient2(low = "darkblue",midpoint=0,mid ='white', high = "red",name = 'log2 Change')+
theme(panel.border = element_blank(),
panel.background = element_blank()
)
plot$symbol= factor(data$symbol,levels = unique(plot$symbol))
ggplot(plot, aes(x = line, y= symbol)) +
geom_tile(aes(fill = log2FoldChange), color = "black") +
geom_text(aes(label = padj),cex=3)+
ylab('Gene')+
xlab('Cell line')+
ggtitle('Expression changes')+
scale_fill_gradient2(low = "darkblue",midpoint=0,mid ='white', high = "red",name = 'log2 Change')+
theme(panel.border = element_blank(),
panel.background = element_blank()
)
plot$symbol= factor(data$symbol,levels = NULL)
ggplot(plot, aes(x = line, y= symbol)) +
geom_tile(aes(fill = log2FoldChange), color = "black") +
geom_text(aes(label = padj),cex=3)+
ylab('Gene')+
xlab('Cell line')+
ggtitle('Expression changes')+
scale_fill_gradient2(low = "darkblue",midpoint=0,mid ='white', high = "red",name = 'log2 Change')+
theme(panel.border = element_blank(),
panel.background = element_blank()
)
plot$symbol= factor(data$symbol,levels = unique(plot$sy))
plot$symbol= factor(data$symbol,levels = unique(plot$symbol))
ggplot(plot, aes(x = line, y= symbol)) +
geom_tile(aes(fill = log2FoldChange), color = "black") +
geom_text(aes(label = padj),cex=3)+
ylab('Gene')+
xlab('Cell line')+
ggtitle('Expression changes')+
scale_fill_gradient2(low = "darkblue",midpoint=0,mid ='white', high = "red",name = 'log2 Change')+
theme(panel.border = element_blank(),
panel.background = element_blank()
)
plot$symbol= factor(data$symbol,levels = plot$symbol)
ggplot(plot, aes(x = line, y= symbol)) +
geom_tile(aes(fill = log2FoldChange), color = "black") +
geom_text(aes(label = padj),cex=3)+
ylab('Gene')+
xlab('Cell line')+
ggtitle('Expression changes')+
scale_fill_gradient2(low = "darkblue",midpoint=0,mid ='white', high = "red",name = 'log2 Change')+
theme(panel.border = element_blank(),
panel.background = element_blank()
)
plot$symbol= factor(data$symbol,levels = unique(plot$symbol))
plot$symbol= factor(plot$symbol,levels = unique(plot$symbol))
ggplot(plot, aes(x = line, y= symbol)) +
geom_tile(aes(fill = log2FoldChange), color = "black") +
geom_text(aes(label = padj),cex=3)+
ylab('Gene')+
xlab('Cell line')+
ggtitle('Expression changes')+
scale_fill_gradient2(low = "darkblue",midpoint=0,mid ='white', high = "red",name = 'log2 Change')+
theme(panel.border = element_blank(),
panel.background = element_blank()
)
# gsea heatmap
gsea$B16gsea_kegg
# gsea heatmap
gsea$B16gsea_kegg%>%arrange(pvalue)
# gsea heatmap
gsea$B16gsea_kegg%>%arrange(pvalue)%>%head()
# gsea heatmap
View(gsea$B16gsea_go)
# gsea heatmap
View(gsea$B16gsea_reactome)
# gsea heatmap
View(gsea$B16gsea_go)
# gsea heatmap
View(gsea$B16gsea_go)
# gsea heatmap
View(gsea$IFNGgsea_go)
go = gsea[grepl('go',names(gsea))]
list1= go$B16gsea_go
list2 = go$TC1A9gsea_go
sim = intersect(list1$ID,list2$ID)
diff= outersect(list1$ID,list2$ID)
list1$line = 'b16'
list2$line = 'tc'
data = rbind(list1,list2)
View(data[data$ID%in%diff,])
View(data[data$ID%in%diff,])
ids = c('GO:0016477','GO:0019882','GO:0060326'.'GO:0006270','GO:0034508','GO:0007155
')
ids = c('GO:0016477','GO:0019882','GO:0060326'.'GO:0006270','GO:0034508','GO:0007155')
ids = c('GO:0016477','GO:0019882','GO:0060326'.'GO:0006270','GO:0034508')
ids = c('GO:0016477','GO:0019882','GO:0060326','GO:0006270','GO:0034508','GO:0007155
')
ids = c('GO:0016477','GO:0019882','GO:0060326','GO:0006270','GO:0034508','GO:0007155')
View(data[data$ID%in%sim,])
min(list1$NES)
View(data[data$ID%in%diff,])
data%>%filter(ID%in%ids)
data%>%filter(ID%in%ids)%>%View()
View(data[data$ID%in%sim,])
sb16=desseq2$B16%>%filter(abs(log2FoldChange)>1&padj<0.05)
sb16
stc=desseq2$TC1A9%>%filter(abs(log2FoldChange)>1&padj<0.05)
length(intersect(sb16$ensembl,stc$ensembl))
gsea_res = unlist(gsea)
gsea_res
?clusterProfiler::gseGO
View(gsea$IFNGgsea_kegg)
View(gsea$IFNGgsea_reactome)
View(gsea$IFNGgsea_go)
View(gsea$IFNGgsea_reactome)
View(gsea$IFNGgsea_go)
View(gsea$IFNGgsea_kegg)
View(gsea$IFNGgsea_kegg)
B16
View(gsea$B16gsea_reactome)
View(gsea$B16gsea_go)
View(gsea$TC1A9gsea_reactome)
View(gsea$TC1A9gsea_go)
go = gsea[grepl('go',names(gsea))]
list1= go$B16gsea_go
list2 = go$TC1A9gsea_go
sim = intersect(list1$ID,list2$ID)
diff= outersect(list1$ID,list2$ID)
list1$line = 'b16'
list2$line = 'tc'
data = rbind(list1,list2)
View(data[data$ID%in%diff,])
View(gsea$IFNGgsea_kegg)
View(gsea$B16gsea_kegg)
gsea_b16 = gsea[grepl(names(gsea),'a')]
gsea_b16 = gsea[grepl('B16',names(gsea))]
gsea_b16
names(gsea_b16)
gsea.tc = gsea[grepl('TC1A9',names(gsea))]
gsea.ifng = gsea[grepl('IFNG',names(gsea))]
gsea.ifng
gsea.grouped = lapply(c('B16','TC1A9','IFNG'),function(name) return(gsea(prepl(name,names(gsea)))))
gsea.grouped = lapply(c('B16','TC1A9','IFNG'),function(name) return(gsea[grepl(name,names(gsea))]))
names(gsea.grouped)
names(gsea.grouped) = c('B16','TC1A9','IFNG')
gsea.grouped
gsea.grouped$B16
names(gsea.grouped$B16)
col1 = function(list){
col2 = function(i){
list[i]$type = names(list)[i]
}
lapply(seq_along(list),col2 )
}
res = lapply(gsea.grouped,col1)
lapply(seq_along(gsea.grouped$B16),print)
lapply(seq_along(gsea.grouped$B16),print(names(gsea.grouped$B16)))
lapply(seq_along(gsea.grouped$B16),print(names(gsea.grouped$B16)[i]))
res = unlist(gsea.grouped)
res
list = gsea.grouped$B16
col = function(i){
df = list[i]
df$type = names(list)[i]
return(df)
}
res=lapply(seq_along(list),col)
str(res)
list[1]
col = function(i){
df = list[i]
df$type = names(list)[[i]]
return(df)
}
res=lapply(seq_along(list),col)
#PCA plot
rld <- rlog(dds)
data <- plotPCA(rld, returnData=TRUE)
data <- plotPCA(rld, intgroup=c("treatment", "cell_line"), returnData=TRUE)
attr(data, "percentVar")
percentVar <- round(100 * attr(data, "percentVar"))
ggplot(data, aes(PC1, PC2, color=treat)) +
geom_point(size=3) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance"))
ggplot(data, aes(PC1, PC2, color=treatment,shape = cell_line)) +
geom_point(size=3) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance"))
ggplot(data, aes(PC1, PC2, color=treatment,shape = cell_line)) +
geom_point(size=3) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
theme_bw()
ggplot(data, aes(PC1, PC2, color=treatment,shape = cell_line)) +
geom_point(size=3) +
ggtitle("Principal Components")+
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
theme_bw()
intersect(desseq2$B16$ensembl,desseq2$TC1A9$ensembl)
length(intersect(desseq2$B16$ensembl,desseq2$TC1A9$ensembl))/length(desseq2$B16$ensembl + length(desseq2$TC1A9$ensembl))
length(intersect(desseq2$B16$ensembl,desseq2$TC1A9$ensembl))/length(desseq2$B16$ensembl) + length(desseq2$TC1A9$ensembl))
length(intersect(desseq2$B16$ensembl,desseq2$TC1A9$ensembl))/(length(desseq2$B16$ensembl) + length(desseq2$TC1A9$ensembl))
length(intersect(desseq2$B16$ensembl,desseq2$TC1A9$ensembl))
length(desseq2$IFNG$ensembl)
b16 = desseq2$B16 %>% filter(abs(log2FoldChange)>1&padj<0.05)
tc = desseq2$TC1A9 %>% filter(abs(log2FoldChange)>1&padj<0.05)
length(intersect(b16$ensembl,tc$ensembl))/(length(tc$ensembl)+length(b16$ensembl))
length(intersect(b16$ensembl,tc$ensembl))
length(b16$ensembl)
length(b16$ensembl)-length(intersect(b16$ensembl,tc$ensembl))
sb16=desseq2$B16%>%filter(abs(log2FoldChange)>1&padj<0.01)
stc=desseq2$TC1A9%>%filter(abs(log2FoldChange)>1&padj<0.01)
length(intersect(sb16$ensembl,stc$ensembl))
length(intersect(desseq2$B16$ensembl,desseq2$TC1A9$ensembl))/(length(desseq2$B16$ensembl) + length(desseq2$TC1A9$ensembl))
b16 = desseq2$B16 %>% filter(abs(log2FoldChange)>1&padj<0.05)
tc = desseq2$TC1A9 %>% filter(abs(log2FoldChange)>1&padj<0.05)
length(b16$ensembl)-length(intersect(b16$ensembl,tc$ensembl))
length(b16$ensembl)
b16 = desseq2$B16 %>% filter(abs(log2FoldChange)>1&padj<0.01)
tc = desseq2$TC1A9 %>% filter(abs(log2FoldChange)>1&padj<0.01)
length(b16$ensembl)-length(intersect(b16$ensembl,tc$ensembl))
length(intersect(b16$ensembl,tc$ensembl))/(length(tc$ensembl)+length(b16$ensembl))
length(b16$ensembl)
length(b16$ensembl)-length(intersect(b16$ensembl,tc$ensembl))
length(tc$ensembl)-length(intersect(b16$ensembl,tc$ensembl))
length(intersect(b16$ensembl,tc$ensembl))
gsea$IFNGgsea_reactome%>%head
gsea$IFNGgsea_reactome%>%filter(Descrition == 'M/G1 Transition')
gsea$IFNGgsea_reactome%>%filter(Description == 'M/G1 Transition')
gsea$IFNGgsea_reactome%>%filter(Description == 'DNA Repai')
gsea$IFNGgsea_reactome$Description
gsea$IFNGgsea_reactome$Description[1]
gsea$IFNGgsea_reactome%>%filter(Description == 'Cytokine Signaling in Immune system')
Cytokine Signaling in Immune system
gsea$IFNGgsea_reactome%>%filter(Description == 'M/G1 Transition')
gsea$IFNGgsea_reactome%>%filter(Description == 'Regulation of DNA replication')
View(gsea$IFNGgsea_reactome)
View(anno)
